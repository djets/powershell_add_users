# powershell_add_users
batch adding users to MS AD

##RUS
Скрипт Add-UserAD.ps1 предназначен для создания пользователей домена на основании исходных данных.
Скрипт запускается ярлыком ADD-USERS.lnk

Файл настроек *.conf должен содержать обязательные параметры:
PATTERN_SEARCH              - Регулярное выражение с именованными группами для трансляции их карту полей записи.
POSITION_FILTER_LIST		    - Список разделенных "," фильтров отбора полученых записей по значению заданного поля . Содержит название поля (FILTER) сответсвующее одной из групп отдоба в верхнем регитстре.
FILTER_LIST_ENABLE		      - Включение фильтрации (допустимые значения: true - включен и false - выключен).
DOMAIN				              - Название домена.
OU_PATH				              - Organization unit куда будут добавляться пользователи.
COMPANY				              - Наименование компании (будет проставлено у всех добавляемых сотрудников).
PASS_NUMBER_GROUP		        - Количество групп в генерируемом пароле.
PASS_GROUP_CHAR_LENGHT		  - Количество символов в группах в генерируемом пароле.
PASS_GROUP_CHAR_SEPARATOR	  - Разделитель групп в генерируемом пароле
DEFAULT_GROUP			          - Список групп по умолчанию для всех пользователей.
GROUPS_PATTERN_DIVISION_1	  - Регулярное выражение на основании которого производтися сопоставление значения поля на основании которого пользователю будут назначены группы. Содержит название поля (PATTERN) сответсвующее одной из групп отдоба в верхнем регитстре. Номер группы для добавления (групп может быть от 1 до 9).
GROUPS_1			              - Список групп, разделенных "," в которые необходимо добавить сотрудника в соответстсвии с шаблоном GROUPS_PATTERN_DIVISION_1. Содержит номер группы для добавления (групп может быть от 1 до 9).

По умолчанию регулярное список для фильтрации содержит должности которым разрешен доступ к ИС.

По умолчанию регулярное выражение для отбора входных данных (выгрузка 1С-ЗуП):

Сотрудник				                  - fio 
Комментарий				                - komment (опционально может содержася в поле исходных данных "Сотрудник")
Дата рождения				              - birthdate
Адрес места проживания			      - registration (может быть пустым)
Серия(паспорт)				            - id_serial (может быть пустым)
Номер(паспорт)				            - id_number (может быть пустым)
Дата(паспорт) выдачи			        - date_of_issue (может быть пустым)
Кем выдано(паспорт)			          - owner_id (может быть пустым)
Код подразделения(паспорт)		    - owner_id_number (может быть пустым)
Должность по штатному расписанию	- position
Подразделение				              - division (содержится в поле исходных данных "Должность по штатному расписанию")
Пол					                      - gender (может быть пустым)

